# BOXOFFICE SERVER

GraphQL Server for Boxoffice

## CONFIG

you should add config or key files

- ./crawling/api_keys.json

```json
{
  "kobis": [${KOBIS_API_KEY}, ...],
  "tmdb": [${TMDB_API_KEY}, ...],
  "naver": [
    {
        "clientId": ${NAVER_CLIENT_ID},
        "clientSecret": ${NAVER_CLIENT_SECRET}
    }
  ]
}
```

- ./crawling/mysql_connect_conf.json

```json
{
  "host": ${DB_SERVER_IP},
  "port": ${DB_SERVER_PORT},
  "user": ${DB_USERNAME},
  "passwd": ${DB_PASSWORD},
  "db": ${DB_NAME}
}
```

- ./config/db.config.js

```js
export const dbConfig = {
  host: ${DB_SERVER_IP},
  user: ${DB_USERNAME},
  password: ${DB_PASSWORD},
  database: ${DB_NAME}
};
```

## DB QUERY

```sql
CREATE DATABASE ${DB_NAME}
```

### DB SCHEMAS

- movie

```sql
CREATE TABLE `movie` (
  `movieCd` varchar(100) NOT NULL,
  `movieNm` varchar(1024) DEFAULT NULL,
  `movieNmEn` varchar(1024) DEFAULT NULL,
  `movieNmOg` varchar(1024) DEFAULT NULL,
  `tmdbId` varchar(255) DEFAULT NULL,
  `multi` enum('Y','N') DEFAULT NULL,
  `nation` enum('K','F') DEFAULT NULL,
  PRIMARY KEY (`movieCd`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4
```

- boxoffice

```sql
CREATE TABLE `boxoffice` (
  `showCnt` bigint DEFAULT NULL,
  `scrnCnt` bigint DEFAULT NULL,
  `rankOldAndNew` tinyint DEFAULT NULL,
  `movieCd` varchar(100) DEFAULT NULL,
  `audiAcc` bigint DEFAULT NULL,
  `audiCnt` bigint DEFAULT NULL,
  `salesShare` double DEFAULT NULL,
  `rank` int DEFAULT NULL,
  `salesAmt` bigint DEFAULT NULL,
  `salesAcc` bigint DEFAULT NULL,
  `currentDate` date DEFAULT NULL,
  `totalRank` int DEFAULT NULL,
  `audiChange` double DEFAULT NULL,
  `salesChange` double DEFAULT NULL,
  `rankInten` int DEFAULT NULL,
  `multi` enum('Y','N') DEFAULT NULL,
  `nation` enum('K','F') DEFAULT NULL,
  KEY `movieCd` (`movieCd`),
  CONSTRAINT `boxoffice_ibfk_1` FOREIGN KEY (`movieCd`) REFERENCES `movie` (`movieCd`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4
```
* target api
```json
[{"movie_name":"유열의 음악앨범","total_rank":[3,3,2,2,7,7,8,8,9,6,8,17,15,13,15,17,22,23,26,39],"date":["2019-09-07","2019-09-08","2019-09-09","2019-09-10","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-25","2019-09-26","2019-09-30","2019-10-13"]},{"movie_name":"신의 한 수: 귀수편","total_rank":[18,8,7,8,7,8,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,7,7,8,6,7,7,9,14,29],"date":["2019-10-28","2019-10-29","2019-10-30","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-05","2019-12-06"]},{"movie_name":"퍼펙트맨","total_rank":[5,4,5,6,8,18,6,4,17,6,6,7,7,3,3,3,3,3,3,3,4,3,4,4,3,3,3,3,5,5,5,5,5,5,6,6,6,7,7,8,10,9,13,17,17,18,20,14,33,22,24,17,17,35],"date":["2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-23","2019-09-24","2019-09-26","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-27","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-08","2019-11-11","2019-11-12","2019-11-14","2019-11-18"]},{"movie_name":"타짜: 원 아이드 잭","total_rank":[2,2,2,2,2,2,2,3,3,3,3,3,3,6,6,6,7,7,6,6,16,19,20,17,21,18,21,25],"date":["2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-11-25"]},{"movie_name":"엑시트","total_rank":[4,4,3,3,5,4,5,5,6,8,10,13,11,9,9,11,12,29,23,30,21,19,17,29,11,17,25,32,17,17,19,13,18,21,23,21,17,32],"date":["2019-09-07","2019-09-08","2019-09-09","2019-09-10","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-28","2019-10-01","2019-10-12","2019-10-18","2019-10-23","2019-10-25","2019-10-28","2019-10-29","2019-10-31","2019-11-03","2019-11-05","2019-11-07","2019-11-08","2019-11-10","2019-11-13","2019-11-14","2019-11-16","2019-11-20","2019-11-21","2019-11-22","2019-11-23"]},{"movie_name":"나를 찾아줘","total_rank":[14,12,2,2,2,2,2,2,2,5,6,7],"date":["2019-11-19","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-04","2019-12-05","2019-12-06"]},{"movie_name":"힘을 내요, 미스터 리","total_rank":[15,13,12,19,3,3,3,3,3,3,4,5,5,5,5,5,6,10,10,10,14,15,13,11,14,26,27,19,13,23,25,16,20,21,21,18,21,30,27,31,30],"date":["2019-09-07","2019-09-08","2019-09-09","2019-09-10","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-04","2019-10-05","2019-10-07","2019-10-08","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-22","2019-10-24","2019-10-25","2019-10-30","2019-10-31","2019-11-05","2019-11-12","2019-11-15"]},{"movie_name":"감쪽같은 그녀","total_rank":[13,7,12,25,9,9,13,20,10,5,18,11,23,11,4,3,3],"date":["2019-10-30","2019-11-11","2019-11-12","2019-11-14","2019-11-18","2019-11-19","2019-11-20","2019-11-22","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-12-02","2019-12-03","2019-12-04","2019-12-05","2019-12-06"]},{"movie_name":"나쁜 녀석들: 더 무비","total_rank":[8,6,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,6,7,8,8,8,6,8,24,24,19,23,21,5,7,25,17,31,30,30,30],"date":["2019-09-09","2019-09-10","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-17","2019-10-22","2019-11-01","2019-11-02","2019-11-03","2019-11-05"]},{"movie_name":"날씨의 아이","total_rank":[8,7,7,8,19,9,7,5,3,3,3,3,3,3,3,3,4,4,5,5,4,4,7,7,7,8,8,7,7,8,12,10,8,8,11,13,16],"date":["2019-10-10","2019-10-14","2019-10-16","2019-10-17","2019-10-18","2019-10-23","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-12-01"]},{"movie_name":"82년생 김지영","total_rank":[21,8,8,10,10,25,7,12,1,1,1,1,1,1,1,2,1,2,2,2,2,1,1,2,2,3,3,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,8,8,7,8,8,8,10,13,19,14],"date":["2019-10-10","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-27","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-04","2019-12-05","2019-12-06"]},{"movie_name":"제미니 맨","total_rank":[23,9,8,6,3,4,3,3,4,4,4,4,6,6,6,6,6,8,16,19,7,23,19],"date":["2019-10-02","2019-10-04","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-27","2019-11-14"]},{"movie_name":"말레피센트 2","total_rank":[24,1,1,1,1,1,1,2,2,2,2,2,3,3,4,5,5,4,4,5,5,4,7,7,7,7,9,8,16,13,12,12,13,22],"date":["2019-10-15","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-27","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-19"]},{"movie_name":"터미네이터: 다크 페이트","total_rank":[18,9,16,9,1,2,1,1,1,1,2,2,3,3,2,2,3,3,4,4,4,4,4,4,4,4,6,5,5,5,5,6,13,21,13,11,13,14,15,22,16],"date":["2019-10-18","2019-10-21","2019-10-25","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-04","2019-12-06"]},{"movie_name":"포드 V 페라리","total_rank":[14,14,9,6,2,2,2],"date":["2019-11-15","2019-11-20","2019-11-28","2019-12-03","2019-12-04","2019-12-05","2019-12-06"]},{"movie_name":"그것: 두 번째 이야기","total_rank":[1,2,1,1,6,6,6,7,4,5,7,11,6,7,8,9,10],"date":["2019-09-07","2019-09-08","2019-09-09","2019-09-10","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24"]},{"movie_name":"애드 아스트라","total_rank":[23,11,2,2,2,2,2,2,5,5,5,5,5,5,5,10,13,13,15,15,14,17,21,23,11,15],"date":["2019-09-09","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-13","2019-10-16","2019-10-22"]},{"movie_name":"장사리 : 잊혀진 영웅들","total_rank":[12,16,10,23,8,1,1,1,1,1,1,1,4,4,4,4,4,4,4,5,5,5,5,5,6,6,6,14,8,21,23,15,18,13,16,15,31,17,20,35,16,26,18,22,25,26,19,23,20,27,15,19,21,22,21,26],"date":["2019-09-18","2019-09-19","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-28","2019-10-30","2019-10-31","2019-11-01","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-11","2019-11-12","2019-11-15","2019-11-20","2019-11-21","2019-11-22","2019-11-27","2019-11-29","2019-12-02","2019-12-05","2019-12-06"]},{"movie_name":"예스터데이","total_rank":[14,9,9,3,4,4,4,4,4,5,8,9,8,9,10,10,8,22,18,16,16,15],"date":["2019-09-10","2019-09-14","2019-09-15","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-04","2019-10-08","2019-10-16","2019-10-17"]},{"movie_name":"극장판 헬로카봇 : 달나라를 구해줘!","total_rank":[2,1,6,7,4,5,4,4,8,7,9,9,9,6,6,10,15,16,25,10,9,11,16,11,11,19,20,19,26,27,34,37,28,31],"date":["2019-09-07","2019-09-08","2019-09-09","2019-09-10","2019-09-12","2019-09-13","2019-09-14","2019-09-15","2019-09-16","2019-09-17","2019-09-18","2019-09-19","2019-09-20","2019-09-21","2019-09-22","2019-09-23","2019-09-24","2019-09-25","2019-09-27","2019-09-28","2019-09-29","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-09","2019-10-12","2019-10-13","2019-10-19","2019-10-20","2019-10-27","2019-11-02","2019-11-09","2019-11-10"]},{"movie_name":"양자물리학","total_rank":[9,11,25,19,7,4,3,3,3,2,2,2,5,6,7,6,7,5,5,18,22,22,21,20,27,15,10],"date":["2019-09-10","2019-09-16","2019-09-20","2019-09-23","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-16","2019-10-21"]},{"movie_name":"블랙머니","total_rank":[28,6,7,8,7,7,8,7,9,8,14,10,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,3,6,7,6],"date":["2019-10-25","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-04","2019-12-05","2019-12-06"]},{"movie_name":"가장 보통의 연애","total_rank":[9,20,14,25,16,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,6,6,6,6,7,6,6,6,10,10,9,9,10,11,20,32,24,27,34,18,23],"date":["2019-09-24","2019-09-26","2019-09-27","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-27","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-21"]},{"movie_name":"겨울왕국 2","total_rank":[16,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"date":["2019-11-20","2019-11-21","2019-11-22","2019-11-23","2019-11-24","2019-11-25","2019-11-26","2019-11-27","2019-11-28","2019-11-29","2019-11-30","2019-12-01","2019-12-02","2019-12-03","2019-12-04","2019-12-05","2019-12-06"]},{"movie_name":"나이브스 아웃","total_rank":[13,9,3,4,4],"date":["2019-11-25","2019-11-26","2019-12-04","2019-12-05","2019-12-06"]},{"movie_name":"원스 어폰 어 타임... 인 할리우드","total_rank":[14,11,3,4,4,4,4,4,4,7,9,10,9,9,7,7,12,14,8,10,11,11,13,20,23,18,20,24,27],"date":["2019-09-19","2019-09-24","2019-09-25","2019-09-26","2019-09-27","2019-09-28","2019-09-29","2019-09-30","2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22"]},{"movie_name":"조커","total_rank":[12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,2,2,5,4,4,5,5,4,4,5,8,9,8,8,8,7,11,12,10,11,11,13,12,24,20,18],"date":["2019-10-01","2019-10-02","2019-10-03","2019-10-04","2019-10-05","2019-10-06","2019-10-07","2019-10-08","2019-10-09","2019-10-10","2019-10-11","2019-10-12","2019-10-13","2019-10-14","2019-10-15","2019-10-16","2019-10-17","2019-10-18","2019-10-19","2019-10-20","2019-10-21","2019-10-22","2019-10-23","2019-10-24","2019-10-25","2019-10-26","2019-10-27","2019-10-28","2019-10-29","2019-10-30","2019-10-31","2019-11-01","2019-11-02","2019-11-03","2019-11-04","2019-11-05","2019-11-06","2019-11-07","2019-11-08","2019-11-09","2019-11-10","2019-11-11","2019-11-12","2019-11-13","2019-11-14","2019-11-15","2019-11-16","2019-11-17","2019-11-18","2019-11-19","2019-11-22","2019-11-23","2019-12-01"]}]
```